# FinanceFlowTracker

## Описание
FinanceFlowTracker — это микросервис, разработанный с использованием Spring Boot, предназначенный для управления финансовыми транзакциями и контроля месячных лимитов расходов. Сервис позволяет записывать транзакции в разных валютах, автоматически конвертировать суммы в USD по актуальным курсам, устанавливать индивидуальные лимиты по категориям расходов и получать отчеты о транзакциях, превысивших установленные лимиты.

## Технологии
- **Spring Boot** — фреймворк для создания и управления RESTful API.
- **Hibernate/JPA** — для работы с реляционной базой данных.
- **Lombok** — библиотека для сокращения шаблонного кода.
- **RestTemplate/WebClient** — для взаимодействия с внешними API (получение курсов валют).
- **Docker** — для контейнеризации приложения.
- **JUnit 5** — для модульного тестирования и написания юнит-тестов.

## Функциональность
- **Запись транзакций**: прием и сохранение информации о расходных операциях в различных валютах (например, KZT, RUB).
- **Месячный лимит расходов**: хранение месячных лимитов по расходам в USD для категорий "товары" и "услуги".
- **Получение курсов валют**: ежедневное обновление курсов валютных пар KZT/USD и RUB/USD с сохранением в базе данных. При отсутствии актуальных данных используется курс предыдущего дня.
- **Флаг превышения лимита**: автоматическое помечание транзакций, превысивших месячный лимит, флагом limit_exceeded.
- **Установка нового лимита**: возможность установки нового лимита расходов с фиксацией текущей даты. Новый лимит не влияет на предыдущие транзакции.
- **Отчет о превышении лимита**: предоставление списка транзакций, превысивших лимит, с указанием суммы лимита, валюты (USD) и даты установления.

## API Эндпоинты

### 1. API для обработки транзакций
| Метод | HTTP Запрос | Описание |
|-------|-------------|----------|
| POST  | `/api/transactions/create` | Создание новой транзакции |
| GET   | `/api/transactions/all` | Получение списка всех транзакций |
| GET   | `/api/transactions/exceeding-limit?limit={limit}` | Получение транзакций, превысивших указанный лимит |
| GET   | `/api/transactions/by-category-and-month` | Получение транзакций по категории и месяцу |
| GET   | `/api/transactions/limit-exceeded-report` | Получение отчета о транзакциях с превышением лимита |

### 2. Клиентский API для управления лимитами
| Метод | HTTP Запрос | Описание |
|-------|-------------|----------|
| POST  | `/api/limits/set` | Установка нового лимита расходов |
| GET   | `/api/limits/all` | Получение списка всех установленных лимитов |
| GET   | `/api/limits/by-category/{category}` | Получение лимитов для указанной категории расходов |

### 3. API для обновления курсов валют
| Метод | HTTP Запрос | Описание |
|-------|-------------|----------|
| GET   | `/update-currency-rates` | Ручное обновление курсов валют |

## Дополнительная информация
- **Валюта по умолчанию**: Все лимиты устанавливаются в USD.
- **Курсы валют**: Курсы валют запрашиваются из внешнего API и кэшируются в базе данных для оптимизации запросов.
- **Обработка курсов на выходные и праздники**: Если курсы валют недоступны на текущую дату, используется последний доступный курс.



----


# Документация по запуску проекта FinanceFlowTracker
## 1. Клонирование репозитория

Склонируйте репозиторий проекта на ваш локальный компьютер. Если вы используете Git, выполните команду:

```bash
git clone https://github.com/Amanzhol-1/FinanceFlowTracker.git
```

## 2. Настройка API ключа для получения курсов валют

### Получите API ключ:
Зарегистрируйтесь на сервисе [Twelve Data](https://www.twelvedata.com/) 

### Укажите API ключ в проекте:
 Откройте файл `CurrencyService.java`, расположенный по пути:
   ```bash
   src/main/java/work/financeflowtracker/service/CurrencyService.java
   ```

 Найдите строку:
   ```java
   String apiKey = "YOUR API KEY";
   ```

3. Замените `"YOUR API KEY"` на ваш реальный API ключ.

## 3. Настройка переменных окружения (при необходимости)

В файле `docker-compose.yml` уже указаны необходимые переменные окружения для приложения и базы данных. При необходимости вы можете изменить их под ваши нужды.

## 4. Запуск приложения

Откройте терминал и перейдите в корневой каталог проекта FinanceFlowTracker:

```bash
cd путь/до/FinanceFlowTracker
```

```bash
docker-compose up --build
```
